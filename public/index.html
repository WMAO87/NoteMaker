<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Note Taker</title>
  <!--JQUERY-->
  <script
  src="https://code.jquery.com/jquery-3.4.1.js"
  integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
  crossorigin="anonymous"></script>
    <!--MATERIALIZED-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
   <!--GOOGLE FONT-->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
   <!--CUSTOMIZED CSS-->
  <link rel="stylesheet" href="assets/css/styles.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="/assets/js/index.js"></script>
    <style>

      #nav-bar{
        padding-left: 17px;
        padding-right: 17px;
      }
      #container{
        width: 65%;
        margin: 0 auto;
      }
      #add-button{
        margin-top: 25px;
        margin-bottom: 10px;
        text-align: end;
        padding-right: 35px;
      }
      .align-right {
      position: absolute;
      right: 0px;
      }
      .relative{
        position: relative;
      }
    </style>
</head>
<body>
    <nav>
        <div id = "nav-bar" class="nav-wrapper">
          <div id = "page-title" class="brand-logo">Notes</div>
        </div>
      </nav>
      <div id = "add-button"><a href="/new-note" class="btn-floating btn-large waves-effect waves-light red" ><i class="material-icons">add</i></a></div>
  <div id = "sideBar" ></div>
  <div id = "container">
      <ul class="collapsible">
      
        </ul>
  </div>
</body>
<script>
//this is for the collapsible functionality
    $(document).ready(function(){
      $('.collapsible').collapsible();
    }); 
//gets data rendered on page
function noteQuery() {
$.ajax({ url: "/api/notes", method: "GET "})
  .then(function(notesData){
    console.log(notesData);

    for (let i = 0; i<notesData.length; i++){
      $('.collapsible').append(` <li>
          <div class="collapsible-header relative"><i value = "${notesData[i].finished}" number = "${notesData[i].index}" id="checkbox" class="material-icons">check_box_outline_blank</i>${notesData[i].title}<i value = "${notesData[i].index}" class="material-icons align-right hide-show">clear</i></div>
          <div class="collapsible-body"><span>${notesData[i].content}</span></div>
          </li>`)
    }
      initialHide();
  })
}
  noteQuery();

// Hover - Hide 
function initialHide() {
  $('.hide-show').hide()
}
$(document).on('mouseover', 'li', function(){
  $(this).find(".hide-show").toggle();
});
$(document).on('mouseout', 'li', function(){
  $(this).find(".hide-show").toggle();
  });
//  delete
$(document).on('click', '.hide-show', function(){
  var buttonValue = $(this).attr("value")
  var indexData = {index: parseInt(buttonValue)}
  $.post("/api/delete", indexData,
  $.post("/api/delete", indexData,
function(data) {
  if (data) {
    console.log("Working?")  }
      });
    console.log($(this).parent().parent().hide())
  });
  

</script>

</html>
